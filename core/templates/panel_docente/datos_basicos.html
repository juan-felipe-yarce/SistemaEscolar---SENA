{% extends "panel_docente/dashboard_base.html" %}
{% load widget_tweaks %}

{% block title %}
  Datos B√°sicos del Docente
{% endblock %}

{% block panel_content %}
<div class="container max-w-4xl px-0">
  <div class="bg-white shadow rounded p-4">
    <h1 class="h4 fw-semibold text-primary mb-3 mt-2">
      <i class="bi bi-person-badge"></i> Datos B√°sicos del Docente
    </h1>

    {% if messages %}
      <div class="mb-3">
        {% for message in messages %}
          <div class="alert {% if message.tags == 'success' %}alert-success{% elif message.tags == 'error' %}alert-danger{% else %}alert-info{% endif %} py-2" role="alert">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" autocomplete="off" novalidate>
      {% csrf_token %}

      <!-- üßæ Identificaci√≥n -->
      <h2 class="h6 fw-semibold text-primary mt-3 mb-2"><i class="bi bi-credit-card-2-front"></i> Datos de Identificaci√≥n</h2>
      {{ form_identificacion.non_field_errors }}
      <div class="row mb-3">
        <div class="col-md-6 mb-3 mb-md-0">
          {{ form_identificacion.tipo_documento.label_tag }}
          {{ form_identificacion.tipo_documento|add_class:"form-select" }}
          {{ form_identificacion.tipo_documento.errors }}
        </div>
        <div class="col-md-6">
          {{ form_identificacion.numero_documento.label_tag }}
          {{ form_identificacion.numero_documento|add_class:"form-control" }}
          {{ form_identificacion.numero_documento.errors }}
        </div>
        <div class="col-12 mt-3">
          {{ form_identificacion.municipio_identificacion.label_tag }}
          {{ form_identificacion.municipio_identificacion|add_class:"form-select" }}
          {{ form_identificacion.municipio_identificacion.errors }}
        </div>
      </div>

      <!-- üôã‚Äç‚ôÇÔ∏è Identidad -->
      <h2 class="h6 fw-semibold text-primary mt-3 mb-2"><i class="bi bi-person"></i> Identidad</h2>
      <div class="row mb-3">
        <div class="col-md-6 mb-3 mb-md-0">
          {{ form_identidad.primer_nombre.label_tag }}
          {{ form_identidad.primer_nombre|add_class:"form-control" }}
        </div>
        <div class="col-md-6">
          {{ form_identidad.segundo_nombre.label_tag }}
          {{ form_identidad.segundo_nombre|add_class:"form-control" }}
        </div>
        <div class="col-md-6 mt-3">
          {{ form_identidad.primer_apellido.label_tag }}
          {{ form_identidad.primer_apellido|add_class:"form-control" }}
        </div>
        <div class="col-md-6 mt-3">
          {{ form_identidad.segundo_apellido.label_tag }}
          {{ form_identidad.segundo_apellido|add_class:"form-control" }}
        </div>
      </div>

      <!-- üéÇ Nacimiento -->
      <h2 class="h6 fw-semibold text-primary mt-3 mb-2"><i class="bi bi-cake2"></i> Nacimiento</h2>
      <div class="row mb-3">
        <div class="col-md-4">
          {{ form_basico.fecha_nacimiento.label_tag }}
          {{ form_basico.fecha_nacimiento|add_class:"form-control" }}
        </div>
        <div class="col-md-4">
          <label for="edad" class="form-label">Edad</label>
          <input type="text" id="edad" name="edad" readonly class="form-control bg-light" />
        </div>
        <div class="col-md-4">
          {{ form_basico.genero.label_tag }}
          {{ form_basico.genero|add_class:"form-select" }}
        </div>
      </div>

      <!-- üè† Domicilio -->
      <h2 class="h6 fw-semibold text-primary mt-3 mb-2"><i class="bi bi-house"></i> Domicilio</h2>
      <div class="row mb-3">
        <div class="col-md-4">
          {{ form_basico.pais_residencia.label_tag }}
          {{ form_basico.pais_residencia|add_class:"form-select" }}
        </div>
        <div class="col-md-4">
          {{ form_basico.departamento_residencia.label_tag }}
          {{ form_basico.departamento_residencia|add_class:"form-select" }}
        </div>
        <div class="col-md-4">
          {{ form_basico.municipio_residencia.label_tag }}
          {{ form_basico.municipio_residencia|add_class:"form-select" }}
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          {{ form_basico.direccion_linea1.label_tag }}
          {{ form_basico.direccion_linea1|add_class:"form-control" }}
        </div>
        <div class="col-md-6">
          {{ form_basico.direccion_linea2.label_tag }}
          {{ form_basico.direccion_linea2|add_class:"form-control" }}
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          {{ form_basico.estrato.label_tag }}
          {{ form_basico.estrato|add_class:"form-select" }}
        </div>
      </div>

      <!-- ‚òéÔ∏è Datos de Contacto -->
      <h2 class="h6 fw-semibold text-primary mt-3 mb-2"><i class="bi bi-telephone"></i> Datos de Contacto</h2>
      <div class="row mb-3">
        <div class="col-md-6">
          {{ form_basico.telefono_celular.label_tag }}
          {{ form_basico.telefono_celular|add_class:"form-control" }}
        </div>
        <div class="col-md-6">
          {{ form_basico.telefono_celular_alterno.label_tag }}
          {{ form_basico.telefono_celular_alterno|add_class:"form-control" }}
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          {{ form_basico.telefono_fijo.label_tag }}
          {{ form_basico.telefono_fijo|add_class:"form-control" }}
        </div>
        <div class="col-md-6">
          {{ form_basico.telefono_fijo_ext.label_tag }}
          {{ form_basico.telefono_fijo_ext|add_class:"form-control" }}
        </div>
      </div>
      <div class="row mb-3">
        <div class="col-md-6">
          {{ form_basico.correo_alterno.label_tag }}
          {{ form_basico.correo_alterno|add_class:"form-control" }}
        </div>
      </div>

      <!-- üéì Perfil Ocupacional -->
      <h2 class="h6 fw-semibold text-primary mt-3 mb-2"><i class="bi bi-award"></i> Perfil Ocupacional</h2>
      <div class="row mb-3">
        <div class="col-12">
          {{ form_basico.resumen.label_tag }}
          {{ form_basico.resumen|add_class:"form-control" }}
        </div>
      </div>

      <!-- üíæ Bot√≥n -->
      <div class="mt-4 text-end">
        <button type="submit" class="btn btn-primary px-4">
          <i class="bi bi-save"></i> Guardar
        </button>
      </div>
    </form>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const birthInput = document.querySelector("#id_fecha_nacimiento");
    const ageOutput = document.querySelector("#edad");

    if (birthInput) {
      function calcularEdad() {
        const birthDate = new Date(birthInput.value);
        const today = new Date();
        let age = today.getFullYear() - birthDate.getFullYear();
        const m = today.getMonth() - birthDate.getMonth();
        if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
          age--;
        }
        ageOutput.value = isNaN(age) ? "" : age;
      }

      birthInput.addEventListener("change", calcularEdad);
      calcularEdad();
    }
  });
</script>
{% endblock %}
